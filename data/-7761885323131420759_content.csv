"Content"
"    package facebooklocation.facebooklocation;&#xD;&#xA;    &#xD;&#xA;    import android.content.Intent;&#xD;&#xA;    import android.content.pm.PackageInfo;&#xD;&#xA;    import android.content.pm.PackageManager;&#xD;&#xA;    import android.content.pm.Signature;&#xD;&#xA;    import android.support.v7.app.AppCompatActivity;&#xD;&#xA;    import android.os.Bundle;&#xD;&#xA;    import android.util.Base64;&#xD;&#xA;    import android.util.Log;&#xD;&#xA;    import android.view.View;&#xD;&#xA;    import android.widget.ImageView;&#xD;&#xA;    import android.widget.LinearLayout;&#xD;&#xA;    import android.widget.TextView;&#xD;&#xA;    import com.bumptech.glide.Glide;&#xD;&#xA;    import com.facebook.AccessToken;&#xD;&#xA;    import com.facebook.CallbackManager;&#xD;&#xA;    import com.facebook.FacebookCallback;&#xD;&#xA;    import com.facebook.FacebookException;&#xD;&#xA;    import com.facebook.FacebookSdk;&#xD;&#xA;    import com.facebook.GraphRequest;&#xD;&#xA;    import com.facebook.GraphResponse;&#xD;&#xA;    import com.facebook.HttpMethod;&#xD;&#xA;    import com.facebook.login.LoginManager;&#xD;&#xA;    import com.facebook.login.LoginResult;&#xD;&#xA;    import org.json.JSONObject;&#xD;&#xA;    import java.security.MessageDigest;&#xD;&#xA;    import java.security.NoSuchAlgorithmException;&#xD;&#xA;    import java.util.Arrays;&#xD;&#xA;    &#xD;&#xA;    public class MainActivity extends AppCompatActivity implements View.OnClickListener {&#xD;&#xA;    &#xD;&#xA;        CallbackManager callbackManager;&#xD;&#xA;        ImageView iv_image, iv_facebook;&#xD;&#xA;        TextView tv_name, tv_email, tv_dob, tv_location, tv_facebook;&#xD;&#xA;        LinearLayout ll_facebook;&#xD;&#xA;        String str_facebookname, str_facebookemail, str_facebookid, str_birthday, str_location;&#xD;&#xA;        boolean boolean_login;&#xD;&#xA;    &#xD;&#xA;        @Override&#xD;&#xA;        protected void onCreate(Bundle savedInstanceState) {&#xD;&#xA;            super.onCreate(savedInstanceState);&#xD;&#xA;            setContentView(R.layout.activity_main);&#xD;&#xA;    &#xD;&#xA;            init();&#xD;&#xA;            getKeyHash();&#xD;&#xA;            listener();&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;        private void init() {&#xD;&#xA;            iv_image = (ImageView) findViewById(R.id.iv_image);&#xD;&#xA;            iv_facebook = (ImageView) findViewById(R.id.iv_facebook);&#xD;&#xA;            tv_name = (TextView) findViewById(R.id.tv_name);&#xD;&#xA;            tv_email = (TextView) findViewById(R.id.tv_email);&#xD;&#xA;            tv_dob = (TextView) findViewById(R.id.tv_dob);&#xD;&#xA;            tv_location = (TextView) findViewById(R.id.tv_location);&#xD;&#xA;            tv_facebook = (TextView) findViewById(R.id.tv_facebook);&#xD;&#xA;            ll_facebook = (LinearLayout) findViewById(R.id.ll_facebook);&#xD;&#xA;            FacebookSdk.sdkInitialize(this.getApplicationContext());&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        private void listener() {&#xD;&#xA;            tv_facebook.setOnClickListener(this);&#xD;&#xA;            ll_facebook.setOnClickListener(this);&#xD;&#xA;            iv_facebook.setOnClickListener(this);&#xD;&#xA;    &#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        private void facebookLogin() {&#xD;&#xA;            callbackManager = CallbackManager.Factory.create();&#xD;&#xA;            LoginManager.getInstance().registerCallback(callbackManager, new FacebookCallback<LoginResult>() {&#xD;&#xA;                @Override&#xD;&#xA;                public void onSuccess(LoginResult loginResult) {&#xD;&#xA;                    Log.e(""""ONSUCCESS"""", """"User ID: """" + loginResult.getAccessToken().getUserId()&#xD;&#xA;                            + """"\n"""" + """"Auth Token: """" + loginResult.getAccessToken().getToken()&#xD;&#xA;                    );&#xD;&#xA;                    GraphRequest request = GraphRequest.newMeRequest(loginResult.getAccessToken(),&#xD;&#xA;                            new GraphRequest.GraphJSONObjectCallback() {&#xD;&#xA;                                @Override&#xD;&#xA;                                public void onCompleted(JSONObject object, GraphResponse response) {&#xD;&#xA;                                    try {&#xD;&#xA;    &#xD;&#xA;                                        boolean_login = true;&#xD;&#xA;                                        tv_facebook.setText(""""Logout from Facebook"""");&#xD;&#xA;    &#xD;&#xA;                                        Log.e(""""object"""", object.toString());&#xD;&#xA;                                        str_facebookname = object.getString(""""name"""");&#xD;&#xA;    &#xD;&#xA;                                        try {&#xD;&#xA;                                            str_facebookemail = object.getString(""""email"""");&#xD;&#xA;                                        } catch (Exception e) {&#xD;&#xA;                                            str_facebookemail = """""""";&#xD;&#xA;                                            e.printStackTrace();&#xD;&#xA;                                        }&#xD;&#xA;    &#xD;&#xA;                                        try {&#xD;&#xA;                                            str_facebookid = object.getString(""""id"""");&#xD;&#xA;                                        } catch (Exception e) {&#xD;&#xA;                                            str_facebookid = """""""";&#xD;&#xA;                                            e.printStackTrace();&#xD;&#xA;    &#xD;&#xA;                                        }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;                                        try {&#xD;&#xA;                                            str_birthday = object.getString(""""birthday"""");&#xD;&#xA;                                        } catch (Exception e) {&#xD;&#xA;                                            str_birthday = """""""";&#xD;&#xA;                                            e.printStackTrace();&#xD;&#xA;                                        }&#xD;&#xA;    &#xD;&#xA;                                        try {&#xD;&#xA;                                            JSONObject jsonobject_location = object.getJSONObject(""""location"""");&#xD;&#xA;                                            str_location = jsonobject_location.getString(""""name"""");&#xD;&#xA;    &#xD;&#xA;                                        } catch (Exception e) {&#xD;&#xA;                                            str_location = """""""";&#xD;&#xA;                                            e.printStackTrace();&#xD;&#xA;                                        }&#xD;&#xA;    &#xD;&#xA;                                        fn_profilepic();&#xD;&#xA;    &#xD;&#xA;                                    } catch (Exception e) {&#xD;&#xA;    &#xD;&#xA;                                    }&#xD;&#xA;                                }&#xD;&#xA;                            });&#xD;&#xA;                    Bundle parameters = new Bundle();&#xD;&#xA;                    parameters.putString(""""fields"""", """"id, name, email,gender,birthday,location"""");&#xD;&#xA;    &#xD;&#xA;                    request.setParameters(parameters);&#xD;&#xA;                    request.executeAsync();&#xD;&#xA;                }&#xD;&#xA;    &#xD;&#xA;                @Override&#xD;&#xA;                public void onCancel() {&#xD;&#xA;                    if (AccessToken.getCurrentAccessToken() == null) {&#xD;&#xA;                        return; // already logged out&#xD;&#xA;                    }&#xD;&#xA;                    new GraphRequest(AccessToken.getCurrentAccessToken(), """"/me/permissions/"""", null, HttpMethod.DELETE, new GraphRequest&#xD;&#xA;                            .Callback() {&#xD;&#xA;                        @Override&#xD;&#xA;                        public void onCompleted(GraphResponse graphResponse) {&#xD;&#xA;                            LoginManager.getInstance().logOut();&#xD;&#xA;                            LoginManager.getInstance().logInWithReadPermissions(MainActivity.this, Arrays.asList(""""public_profile,email""""));&#xD;&#xA;                            facebookLogin();&#xD;&#xA;    &#xD;&#xA;                        }&#xD;&#xA;                    }).executeAsync();&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;                }&#xD;&#xA;    &#xD;&#xA;                @Override&#xD;&#xA;                public void onError(FacebookException e) {&#xD;&#xA;                    Log.e(""""ON ERROR"""", """"Login attempt failed."""");&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;                    AccessToken.setCurrentAccessToken(null);&#xD;&#xA;                    LoginManager.getInstance().logInWithReadPermissions(MainActivity.this, Arrays.asList(""""public_profile,email,user_birthday""""));&#xD;&#xA;                }&#xD;&#xA;            });&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        @Override&#xD;&#xA;        public void onActivityResult(int requestCode, int resultCode, Intent data) {&#xD;&#xA;            super.onActivityResult(requestCode, resultCode, data);&#xD;&#xA;    &#xD;&#xA;            try {&#xD;&#xA;                callbackManager.onActivityResult(requestCode, resultCode, data);&#xD;&#xA;            } catch (Exception e) {&#xD;&#xA;    &#xD;&#xA;            }&#xD;&#xA;    &#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        private void getKeyHash() {&#xD;&#xA;            // Add code to print out the key hash&#xD;&#xA;            try {&#xD;&#xA;                PackageInfo info = getPackageManager().getPackageInfo(""""facebooklocation.facebooklocation"""", PackageManager.GET_SIGNATURES);&#xD;&#xA;                for (Signature signature : info.signatures) {&#xD;&#xA;                    MessageDigest md = MessageDigest.getInstance(""""SHA"""");&#xD;&#xA;                    md.update(signature.toByteArray());&#xD;&#xA;                    Log.d(""""KeyHash:"""", Base64.encodeToString(md.digest(), Base64.DEFAULT));&#xD;&#xA;                }&#xD;&#xA;            } catch (PackageManager.NameNotFoundException e) {&#xD;&#xA;    &#xD;&#xA;            } catch (NoSuchAlgorithmException e) {&#xD;&#xA;    &#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        private void fn_profilepic() {&#xD;&#xA;    &#xD;&#xA;            Bundle params = new Bundle();&#xD;&#xA;            params.putBoolean(""""redirect"""", false);&#xD;&#xA;            params.putString(""""type"""", """"large"""");&#xD;&#xA;            new GraphRequest(&#xD;&#xA;                    AccessToken.getCurrentAccessToken(),&#xD;&#xA;                    """"me/picture"""",&#xD;&#xA;                    params,&#xD;&#xA;                    HttpMethod.GET,&#xD;&#xA;                    new GraphRequest.Callback() {&#xD;&#xA;                        public void onCompleted(GraphResponse response) {&#xD;&#xA;    &#xD;&#xA;                            Log.e(""""Response 2"""", response + """""""");&#xD;&#xA;    &#xD;&#xA;                            try {&#xD;&#xA;                                String str_facebookimage = (String) response.getJSONObject().getJSONObject(""""data"""").get(""""url"""");&#xD;&#xA;                                Log.e(""""Picture"""", str_facebookimage);&#xD;&#xA;    &#xD;&#xA;                                Glide.with(MainActivity.this).load(str_facebookimage).skipMemoryCache(true).into(iv_image);&#xD;&#xA;    &#xD;&#xA;                            } catch (Exception e) {&#xD;&#xA;                                e.printStackTrace();&#xD;&#xA;                            }&#xD;&#xA;    &#xD;&#xA;                            tv_name.setText(str_facebookname);&#xD;&#xA;                            tv_email.setText(str_facebookemail);&#xD;&#xA;                            tv_dob.setText(str_birthday);&#xD;&#xA;                            tv_location.setText(str_location);&#xD;&#xA;    &#xD;&#xA;                        }&#xD;&#xA;                    }&#xD;&#xA;            ).executeAsync();&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;        @Override&#xD;&#xA;        public void onClick(View view) {&#xD;&#xA;    &#xD;&#xA;            if (boolean_login) {&#xD;&#xA;                boolean_login = false;&#xD;&#xA;                LoginManager.getInstance().logOut();&#xD;&#xA;                tv_location.setText("""""""");&#xD;&#xA;                tv_dob.setText("""""""");&#xD;&#xA;                tv_email.setText("""""""");&#xD;&#xA;                tv_name.setText("""""""");&#xD;&#xA;                Glide.with(MainActivity.this).load(R.drawable.profile).into(iv_image);&#xD;&#xA;                tv_facebook.setText(""""Login with Facebook"""");&#xD;&#xA;            } else {&#xD;&#xA;                LoginManager.getInstance().logInWithReadPermissions(MainActivity.this, Arrays.asList(""""public_profile,email,user_birthday,user_location""""));&#xD;&#xA;                facebookLogin();&#xD;&#xA;            }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;        @Override&#xD;&#xA;        protected void onDestroy() {&#xD;&#xA;            super.onDestroy();&#xD;&#xA;            LoginManager.getInstance().logOut();&#xD;&#xA;        }&#xD;&#xA;    }"
