"Content"
"    CREATE FUNCTION [dbo].[FN_ListToTable]&#xD;&#xA;    (&#xD;&#xA;         @SplitOn  char(1)      --REQUIRED, the character to split the @List string on&#xD;&#xA;        ,@List     varchar(8000)--REQUIRED, the list to split apart&#xD;&#xA;    )&#xD;&#xA;    RETURNS TABLE&#xD;&#xA;    AS&#xD;&#xA;    RETURN &#xD;&#xA;    (   ----------------&#xD;&#xA;        --SINGLE QUERY-- --this will not return empty rows&#xD;&#xA;        ----------------&#xD;&#xA;        SELECT&#xD;&#xA;            ListValue&#xD;&#xA;            FROM (SELECT&#xD;&#xA;                      LTRIM(RTRIM(SUBSTRING(List2, number+1, CHARINDEX(@SplitOn, List2, number+1)-number - 1))) AS ListValue&#xD;&#xA;                      FROM (&#xD;&#xA;                               SELECT @SplitOn + @List + @SplitOn AS List2&#xD;&#xA;                           ) AS dt&#xD;&#xA;                          INNER JOIN Numbers n ON n.Number < LEN(dt.List2)&#xD;&#xA;                      WHERE SUBSTRING(List2, number, 1) = @SplitOn&#xD;&#xA;                 ) dt2&#xD;&#xA;            WHERE ListValue IS NOT NULL AND ListValue!=''&#xD;&#xA;    );&#xD;&#xA;    GO "
