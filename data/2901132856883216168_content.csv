"Content"
"    Public Function RowCounter( _&#xD;&#xA;      ByVal strKey As String, _&#xD;&#xA;      ByVal booReset As Boolean, _&#xD;&#xA;      Optional ByVal strGroupKey As String) _&#xD;&#xA;      As Long&#xD;&#xA;      &#xD;&#xA;    ' Builds consecutive RowIDs in select, append or create query&#xD;&#xA;    ' with the possibility of automatic reset.&#xD;&#xA;    ' Optionally a grouping key can be passed to reset the row count&#xD;&#xA;    ' for every group key.&#xD;&#xA;    '&#xD;&#xA;    ' Usage (typical select query):&#xD;&#xA;    '   SELECT RowCounter(CStr([ID]),False) AS RowID, *&#xD;&#xA;    '   FROM tblSomeTable&#xD;&#xA;    '   WHERE (RowCounter(CStr([ID]),False) <> RowCounter("""""""",True));&#xD;&#xA;    '&#xD;&#xA;    ' Usage (with group key):&#xD;&#xA;    '   SELECT RowCounter(CStr([ID]),False,CStr[GroupID])) AS RowID, *&#xD;&#xA;    '   FROM tblSomeTable&#xD;&#xA;    '   WHERE (RowCounter(CStr([ID]),False) <> RowCounter("""""""",True));&#xD;&#xA;    '&#xD;&#xA;    ' The Where statement resets the counter when the query is run&#xD;&#xA;    ' and is needed for browsing a select query.&#xD;&#xA;    '&#xD;&#xA;    ' Usage (typical append query, manual reset):&#xD;&#xA;    ' 1. Reset counter manually:&#xD;&#xA;    '   Call RowCounter(vbNullString, False)&#xD;&#xA;    ' 2. Run query:&#xD;&#xA;    '   INSERT INTO tblTemp ( RowID )&#xD;&#xA;    '   SELECT RowCounter(CStr([ID]),False) AS RowID, *&#xD;&#xA;    '   FROM tblSomeTable;&#xD;&#xA;    '&#xD;&#xA;    ' Usage (typical append query, automatic reset):&#xD;&#xA;    '   INSERT INTO tblTemp ( RowID )&#xD;&#xA;    '   SELECT RowCounter(CStr([ID]),False) AS RowID, *&#xD;&#xA;    '   FROM tblSomeTable&#xD;&#xA;    '   WHERE (RowCounter("""""""",True)=0);&#xD;&#xA;    '&#xD;&#xA;    ' 2002-04-13. Cactus Data ApS. CPH&#xD;&#xA;    ' 2002-09-09. Str() sometimes fails. Replaced with CStr().&#xD;&#xA;    ' 2005-10-21. Str(col.Count + 1) reduced to col.Count + 1.&#xD;&#xA;    ' 2008-02-27. Optional group parameter added.&#xD;&#xA;    ' 2010-08-04. Corrected that group key missed first row in group.&#xD;&#xA;    &#xD;&#xA;      Static col      As New Collection&#xD;&#xA;      Static strGroup As String&#xD;&#xA;      &#xD;&#xA;      On Error GoTo Err_RowCounter&#xD;&#xA;      &#xD;&#xA;      If booReset = True Then&#xD;&#xA;        Set col = Nothing&#xD;&#xA;      ElseIf strGroup <> strGroupKey Then&#xD;&#xA;        Set col = Nothing&#xD;&#xA;        strGroup = strGroupKey&#xD;&#xA;        col.Add 1, strKey&#xD;&#xA;      Else&#xD;&#xA;        col.Add col.Count + 1, strKey&#xD;&#xA;      End If&#xD;&#xA;      &#xD;&#xA;      RowCounter = col(strKey)&#xD;&#xA;      &#xD;&#xA;    Exit_RowCounter:&#xD;&#xA;      Exit Function&#xD;&#xA;      &#xD;&#xA;    Err_RowCounter:&#xD;&#xA;      Select Case Err&#xD;&#xA;        Case 457&#xD;&#xA;          ' Key is present.&#xD;&#xA;          Resume Next&#xD;&#xA;        Case Else&#xD;&#xA;          ' Some other error.&#xD;&#xA;          Resume Exit_RowCounter&#xD;&#xA;      End Select&#xD;&#xA;    &#xD;&#xA;    End Function"
