"Content"
"    CREATE FUNCTION [dbo].[udf-Str-Extract] (@String varchar(max),@Delimiter1 varchar(100),@Delimiter2 varchar(100))&#xD;&#xA;    Returns Table &#xD;&#xA;    As&#xD;&#xA;    Return (  &#xD;&#xA;    &#xD;&#xA;    with   cte1(N)   As (Select 1 From (Values(1),(1),(1),(1),(1),(1),(1),(1),(1),(1)) N(N)),&#xD;&#xA;           cte2(N)   As (Select Top (IsNull(DataLength(@String),0)) Row_Number() over (Order By (Select NULL)) From (Select N=1 From cte1 N1,cte1 N2,cte1 N3,cte1 N4,cte1 N5,cte1 N6) A ),&#xD;&#xA;    	   cte3(N)   As (Select 1 Union All Select t.N+DataLength(@Delimiter1) From cte2 t Where Substring(@String,t.N,DataLength(@Delimiter1)) = @Delimiter1),&#xD;&#xA;    	   cte4(N,L) As (Select S.N,IsNull(NullIf(CharIndex(@Delimiter1,@String,s.N),0)-S.N,8000) From cte3 S)&#xD;&#xA;    &#xD;&#xA;    Select RetSeq = Row_Number() over (Order By N)&#xD;&#xA;          ,RetPos = N&#xD;&#xA;    	  ,RetVal = left(RetVal,charindex(@Delimiter2,RetVal)-1) &#xD;&#xA;     From  (&#xD;&#xA;            Select *,RetVal = Substring(@String, N, L) &#xD;&#xA;    	     From  cte4&#xD;&#xA;    	   ) A&#xD;&#xA;     Where charindex(@Delimiter2,RetVal)>1&#xD;&#xA;    &#xD;&#xA;    )&#xD;&#xA;    /*&#xD;&#xA;    Max Length of String 1MM characters&#xD;&#xA;    &#xD;&#xA;    Declare @String varchar(max) = 'Dear [[FirstName]] [[LastName]], ...'&#xD;&#xA;    Select * From [dbo].[udf-Str-Extract] (@String,'[[',']]')&#xD;&#xA;    */"
