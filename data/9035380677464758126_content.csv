"Content"
"        public static void SetFontSize(RichTextBox target, double value)&#xD;&#xA;        {&#xD;&#xA;            // Make sure we have a richtextbox.&#xD;&#xA;            if (target == null)&#xD;&#xA;                return;&#xD;&#xA;            // Make sure we have a selection. Should have one even if there is no text selected.&#xD;&#xA;            if (target.Selection != null)&#xD;&#xA;            {&#xD;&#xA;                // Check whether there is text selected or just sitting at cursor&#xD;&#xA;                if (target.Selection.IsEmpty)&#xD;&#xA;                {&#xD;&#xA;                    // Check to see if we are at the start of the textbox and nothing has been added yet&#xD;&#xA;                    if (target.Selection.Start.Paragraph == null)&#xD;&#xA;                    {&#xD;&#xA;                        // Add a new paragraph object to the richtextbox with the fontsize&#xD;&#xA;                        Paragraph p = new Paragraph();&#xD;&#xA;                        p.FontSize = value;&#xD;&#xA;                        target.Document.Blocks.Add(p);&#xD;&#xA;                    }&#xD;&#xA;                    else&#xD;&#xA;                    {&#xD;&#xA;                        // Get current position of cursor&#xD;&#xA;                        TextPointer curCaret = target.CaretPosition;&#xD;&#xA;                        // Get the current block object that the cursor is in&#xD;&#xA;                        Block curBlock = target.Document.Blocks.Where&#xD;&#xA;                            (x => x.ContentStart.CompareTo(curCaret) == -1 && x.ContentEnd.CompareTo(curCaret) == 1).FirstOrDefault();&#xD;&#xA;                        if (curBlock != null)&#xD;&#xA;                        {&#xD;&#xA;                            Paragraph curParagraph = curBlock as Paragraph;&#xD;&#xA;                            // Create a new run object with the fontsize, and add it to the current block&#xD;&#xA;                            Run newRun = new Run();&#xD;&#xA;                            newRun.FontSize = value;&#xD;&#xA;                            curParagraph.Inlines.Add(newRun);&#xD;&#xA;                            // Reset the cursor into the new block. &#xD;&#xA;                            // If we don't do this, the font size will default again when you start typing.&#xD;&#xA;                            target.CaretPosition = newRun.ElementStart;&#xD;&#xA;                        }&#xD;&#xA;                    }&#xD;&#xA;                }&#xD;&#xA;                else // There is selected text, so change the fontsize of the selection&#xD;&#xA;                {&#xD;&#xA;                    TextRange selectionTextRange = new TextRange(target.Selection.Start, target.Selection.End);&#xD;&#xA;                    selectionTextRange.ApplyPropertyValue(TextElement.FontSizeProperty, value);&#xD;&#xA;                }&#xD;&#xA;            }&#xD;&#xA;            // Reset the focus onto the richtextbox after selecting the font in a toolbar etc&#xD;&#xA;            target.Focus();&#xD;&#xA;        }"
