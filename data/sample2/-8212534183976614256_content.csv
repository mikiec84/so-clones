"Content"
"    Option Explicit&#xD;&#xA;    &#xD;&#xA;    Private Type LARGE_INTEGER&#xD;&#xA;        lowpart As Long&#xD;&#xA;        highpart As Long&#xD;&#xA;    End Type&#xD;&#xA;    &#xD;&#xA;    Private Declare Function QueryPerformanceCounter Lib """"kernel32"""" (lpPerformanceCount As LARGE_INTEGER) As Long&#xD;&#xA;    Private Declare Function QueryPerformanceFrequency Lib """"kernel32"""" (lpFrequency As LARGE_INTEGER) As Long&#xD;&#xA;    &#xD;&#xA;    Private m_CounterStart As LARGE_INTEGER&#xD;&#xA;    Private m_CounterEnd As LARGE_INTEGER&#xD;&#xA;    Private m_crFrequency As Double&#xD;&#xA;    &#xD;&#xA;    Private Const TWO_32 = 4294967296# ' = 256# * 256# * 256# * 256#&#xD;&#xA;    &#xD;&#xA;    Private Function LI2Double(LI As LARGE_INTEGER) As Double&#xD;&#xA;    Dim Low As Double&#xD;&#xA;        Low = LI.lowpart&#xD;&#xA;        If Low < 0 Then&#xD;&#xA;            Low = Low + TWO_32&#xD;&#xA;        End If&#xD;&#xA;        LI2Double = LI.highpart * TWO_32 + Low&#xD;&#xA;    End Function&#xD;&#xA;    &#xD;&#xA;    Private Sub Class_Initialize()&#xD;&#xA;        Dim PerfFrequency As LARGE_INTEGER&#xD;&#xA;        &#xD;&#xA;        QueryPerformanceFrequency PerfFrequency&#xD;&#xA;        m_crFrequency = LI2Double(PerfFrequency)&#xD;&#xA;    End Sub&#xD;&#xA;    &#xD;&#xA;    Public Sub StartCounter()&#xD;&#xA;        QueryPerformanceCounter m_CounterStart&#xD;&#xA;    End Sub&#xD;&#xA;    &#xD;&#xA;    Property Get TimeElapsed() As Double&#xD;&#xA;    Dim crStart As Double&#xD;&#xA;    Dim crStop As Double&#xD;&#xA;        QueryPerformanceCounter m_CounterEnd&#xD;&#xA;        crStart = LI2Double(m_CounterStart)&#xD;&#xA;        crStop = LI2Double(m_CounterEnd)&#xD;&#xA;        TimeElapsed = 1000# * (crStop - crStart) / m_crFrequency&#xD;&#xA;    End Property"
