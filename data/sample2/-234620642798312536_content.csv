"Content"
"    ' Converts a value of any type to its string representation.&#xD;&#xA;    ' The function can be concatenated into an SQL expression as is&#xD;&#xA;    ' without any delimiters or leading/trailing white-space.&#xD;&#xA;    '&#xD;&#xA;    ' Examples:&#xD;&#xA;    '   SQL = """"Select * From TableTest Where [Amount]>"""" & CSql(12.5) & """"And [DueDate]<"""" & CSql(Date) & """"""""&#xD;&#xA;    '   SQL -> Select * From TableTest Where [Amount]> 12.5 And [DueDate]< #2016/01/30 00:00:00#&#xD;&#xA;    '&#xD;&#xA;    '   SQL = """"Insert Into TableTest ( [Street] ) Values ("""" & CSql("""" """") & """")""""&#xD;&#xA;    '   SQL -> Insert Into TableTest ( [Street] ) Values ( Null )&#xD;&#xA;    '&#xD;&#xA;    ' Trims text variables for leading/trailing Space and secures single quotes.&#xD;&#xA;    ' Replaces zero length strings with Null.&#xD;&#xA;    ' Formats date/time variables as safe string expressions.&#xD;&#xA;    ' Uses Str to format decimal values to string expressions.&#xD;&#xA;    ' Returns Null for values that cannot be expressed with a string expression.&#xD;&#xA;    '&#xD;&#xA;    ' 2016-01-30. Gustav Brock, Cactus Data ApS, CPH.&#xD;&#xA;    '&#xD;&#xA;    Public Function CSql( _&#xD;&#xA;        ByVal Value As Variant) _&#xD;&#xA;        As String&#xD;&#xA;        &#xD;&#xA;        Const vbLongLong    As Integer = 20&#xD;&#xA;        Const SqlNull       As String = """" Null""""&#xD;&#xA;        &#xD;&#xA;        Dim Sql             As String&#xD;&#xA;        Dim LongLong        As Integer&#xD;&#xA;        &#xD;&#xA;        #If Win32 Then&#xD;&#xA;            LongLong = vbLongLong&#xD;&#xA;        #End If&#xD;&#xA;        #If Win64 Then&#xD;&#xA;            LongLong = VBA.vbLongLong&#xD;&#xA;        #End If&#xD;&#xA;    &#xD;&#xA;        Select Case VarType(Value)&#xD;&#xA;            Case vbEmpty            '    0  Empty (uninitialized).&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case vbNull             '    1  Null (no valid data).&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case vbInteger          '    2  Integer.&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case vbLong             '    3  Long integer.&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case vbSingle           '    4  Single-precision floating-point number.&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case vbDouble           '    5  Double-precision floating-point number.&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case vbCurrency         '    6  Currency.&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case vbDate             '    7  Date.&#xD;&#xA;                Sql = Format(Value, """" \#yyyy\/mm\/dd hh\:nn\:ss\#"""")&#xD;&#xA;            Case vbString           '    8  String.&#xD;&#xA;                Sql = Replace(Trim(Value), """"'"""", """"''"""")&#xD;&#xA;                If Sql = """""""" Then&#xD;&#xA;                    Sql = SqlNull&#xD;&#xA;                Else&#xD;&#xA;                    Sql = """" '"""" & Sql & """"'""""&#xD;&#xA;                End If&#xD;&#xA;            Case vbObject           '    9  Object.&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case vbError            '   10  Error.&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case vbBoolean          '   11  Boolean.&#xD;&#xA;                Sql = Str(Abs(Value))&#xD;&#xA;            Case vbVariant          '   12  Variant (used only with arrays of variants).&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case vbDataObject       '   13  A data access object.&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case vbDecimal          '   14  Decimal.&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case vbByte             '   17  Byte.&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case LongLong           '   20  LongLong integer (Valid on 64-bit platforms only).&#xD;&#xA;                Sql = Str(Value)&#xD;&#xA;            Case vbUserDefinedType  '   36  Variants that contain user-defined types.&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case vbArray            ' 8192  Array.&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;            Case Else               '       Should not happen.&#xD;&#xA;                Sql = SqlNull&#xD;&#xA;        End Select&#xD;&#xA;    &#xD;&#xA;        CSql = Sql & """" """"&#xD;&#xA;        &#xD;&#xA;    End Function"
