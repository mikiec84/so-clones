"Content"
"    -- PatternSplitCM will split a string based on a pattern of the form &#xD;&#xA;    -- supported by LIKE and PATINDEX &#xD;&#xA;    -- &#xD;&#xA;    -- Created by: Chris Morris 12-Oct-2012 &#xD;&#xA;    CREATE FUNCTION [dbo].[PatternSplitCM]&#xD;&#xA;    (&#xD;&#xA;           @List                VARCHAR(8000) = NULL&#xD;&#xA;           ,@Pattern            VARCHAR(50)&#xD;&#xA;    ) RETURNS TABLE WITH SCHEMABINDING &#xD;&#xA;    AS &#xD;&#xA;    &#xD;&#xA;    RETURN&#xD;&#xA;        WITH numbers AS (&#xD;&#xA;    		SELECT TOP(ISNULL(DATALENGTH(@List), 0))&#xD;&#xA;    			n = ROW_NUMBER() OVER(ORDER BY (SELECT NULL))&#xD;&#xA;    		FROM&#xD;&#xA;    		(VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) d (n),&#xD;&#xA;    		(VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) e (n),&#xD;&#xA;    		(VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) f (n),&#xD;&#xA;    		(VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) g (n)&#xD;&#xA;    	)&#xD;&#xA;    &#xD;&#xA;    	SELECT&#xD;&#xA;    		ItemNumber = ROW_NUMBER() OVER(ORDER BY MIN(n)),&#xD;&#xA;    		Item = SUBSTRING(@List,MIN(n),1+MAX(n)-MIN(n)),&#xD;&#xA;    		[Matched]&#xD;&#xA;    	FROM (&#xD;&#xA;    		SELECT n, y.[Matched], Grouper = n - ROW_NUMBER() OVER(ORDER BY y.[Matched],n)&#xD;&#xA;    		FROM numbers&#xD;&#xA;    		CROSS APPLY (&#xD;&#xA;    			SELECT [Matched] = CASE WHEN SUBSTRING(@List,n,1) LIKE @Pattern THEN 1 ELSE 0 END&#xD;&#xA;    		) y&#xD;&#xA;    	) d&#xD;&#xA;    	GROUP BY [Matched], Grouper"
