"Content"
"    CREATE  PROCEDURE [dbo].[usp_PageResults_NAI] &#xD;&#xA;    (&#xD;&#xA;        @startRowIndex int,&#xD;&#xA;        @maximumRows int&#xD;&#xA;    )&#xD;&#xA;    AS&#xD;&#xA;    &#xD;&#xA;    DECLARE @first_id int, @startRow int&#xD;&#xA;    	&#xD;&#xA;    -- A check can be added to make sure @startRowIndex isn't > count(1)&#xD;&#xA;    -- from employees before doing any actual work unless it is guaranteed&#xD;&#xA;    -- the caller won't do that&#xD;&#xA;    &#xD;&#xA;    -- Get the first employeeID for our page of records&#xD;&#xA;    SET ROWCOUNT @startRowIndex&#xD;&#xA;    SELECT @first_id = employeeID FROM employees ORDER BY employeeid&#xD;&#xA;    &#xD;&#xA;    -- Now, set the row count to MaximumRows and get&#xD;&#xA;    -- all records >= @first_id&#xD;&#xA;    SET ROWCOUNT @maximumRows&#xD;&#xA;    &#xD;&#xA;    SELECT e.*, d.name as DepartmentName &#xD;&#xA;    FROM employees e&#xD;&#xA;       INNER JOIN Departments D ON&#xD;&#xA;           e.DepartmentID = d.DepartmentID&#xD;&#xA;    WHERE employeeid >= @first_id&#xD;&#xA;    ORDER BY e.EmployeeID&#xD;&#xA;    &#xD;&#xA;    SET ROWCOUNT 0&#xD;&#xA;    &#xD;&#xA;    GO "
