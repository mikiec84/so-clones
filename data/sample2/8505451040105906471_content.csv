"Content"
"    HelpMsg = vbcrlf & """"  ShVerb"""" & vbcrlf & vbcrlf & """"  David Candy 2014"""" & vbcrlf & vbcrlf & """"  Lists or runs an explorer verb (right click menu) on a file or folder"""" & vbcrlf  & vbcrlf & """"    ShVerb <filename> [verb]"""" & vbcrlf & vbcrlf & """"  Used without a verb it lists the verbs available for the file or folder"""" & vbcrlf & vbcrlf&#xD;&#xA;    HelpMsg = HelpMsg & """"  The program lists most verbs but only ones above the first separator"""" & vbcrlf & """"  of the menu work when used this way"""" & vbcrlf & vbcrlf &#xD;&#xA;    HelpMsg = HelpMsg & """"  The Properties verb can be used. However the program has to keep running"""" & vbcrlf & """"  to hold the properties dialog open. It keeps running by displaying"""" & vbcrlf & """"  a message box."""" &#xD;&#xA;    Set objShell = CreateObject(""""Shell.Application"""")&#xD;&#xA;    Set Ag = WScript.Arguments &#xD;&#xA;    set WshShell = WScript.CreateObject(""""WScript.Shell"""") &#xD;&#xA;    Set fso = CreateObject(""""Scripting.FileSystemObject"""")&#xD;&#xA;    &#xD;&#xA;    	If Ag.count = 0 then &#xD;&#xA;    		wscript.echo """"  ShVerb - No file specified""""&#xD;&#xA;    		wscript.echo HelpMsg &#xD;&#xA;    		wscript.quit&#xD;&#xA;    	Else If Ag.count = 1 then &#xD;&#xA;    		If LCase(Replace(Ag(0),""""-"""", """"/"""")) = """"/h"""" or Replace(Ag(0),""""-"""", """"/"""") = """"/?"""" then &#xD;&#xA;    			wscript.echo HelpMsg &#xD;&#xA;    			wscript.quit&#xD;&#xA;    		End If&#xD;&#xA;    	ElseIf Ag.count > 2 then &#xD;&#xA;    		wscript.echo vbcrlf & """"  ShVerb - To many parameters"""" & vbcrlf & """"  Use quotes around filenames and verbs containing spaces""""  & vbcrlf&#xD;&#xA;    		wscript.echo HelpMsg &#xD;&#xA;    		wscript.quit&#xD;&#xA;    	End If&#xD;&#xA;    &#xD;&#xA;    	If fso.DriveExists(Ag(0)) = True then&#xD;&#xA;    		Set objFolder = objShell.Namespace(fso.GetFileName(Ag(0)))&#xD;&#xA;    '		Set objFolderItem = objFolder.ParseName(fso.GetFileName(Ag(0)))&#xD;&#xA;    		Set objFolderItem = objFolder.self&#xD;&#xA;    		msgbox ag(0)&#xD;&#xA;    	ElseIf fso.FolderExists(Ag(0)) = True then&#xD;&#xA;    		Set objFolder = objShell.Namespace(fso.GetParentFolderName(Ag(0)))&#xD;&#xA;    		Set objFolderItem = objFolder.ParseName(fso.GetFileName(Ag(0)))&#xD;&#xA;    	ElseIf fso.fileExists(Ag(0)) = True then&#xD;&#xA;    		Set objFolder = objShell.Namespace(fso.GetParentFolderName(Ag(0)))&#xD;&#xA;    		Set objFolderItem = objFolder.ParseName(fso.GetFileName(Ag(0)))&#xD;&#xA;    	Else&#xD;&#xA;    		wscript.echo """"  ShVerb - """" & Ag(0) & """" not found""""&#xD;&#xA;    		wscript.echo HelpMsg &#xD;&#xA;    		wscript.quit&#xD;&#xA;    	End If&#xD;&#xA;    &#xD;&#xA;    	Set objVerbs = objFolderItem.Verbs&#xD;&#xA;    	'If only one argument list verbs for that item&#xD;&#xA;    &#xD;&#xA;    	If Ag.count = 1 then&#xD;&#xA;    		For Each cmd in objFolderItem.Verbs&#xD;&#xA;    			If len(cmd) <> 0 then CmdList = CmdList & vbcrlf & replace(cmd.name, """"&"""", """""""") &#xD;&#xA;    		Next&#xD;&#xA;    		wscript.echo mid(CmdList, 2)&#xD;&#xA;    &#xD;&#xA;    	'If two arguments do verbs for that item&#xD;&#xA;    &#xD;&#xA;    	ElseIf Ag.count = 2 then&#xD;&#xA;    		For Each cmd in objFolderItem.Verbs&#xD;&#xA;    			If lcase(replace(cmd, """"&"""", """""""")) = LCase(Ag(1)) then &#xD;&#xA;    				wscript.echo Cmd.doit &#xD;&#xA;    				Exit For&#xD;&#xA;    			End If&#xD;&#xA;    		Next&#xD;&#xA;    	'Properties is special cased. Script has to stay running for Properties dialog to show.&#xD;&#xA;    		If Lcase(Ag(1)) = """"properties"""" then&#xD;&#xA;    			WSHShell.AppActivate(ObjFolderItem.Name & """" Properties"""")&#xD;&#xA;    			msgbox """"This message box has to stay open to keep the """" & ObjFolderItem.Name & """" Properties dialog open.""""&#xD;&#xA;    		End If	&#xD;&#xA;    	End If&#xD;&#xA;    End If"
