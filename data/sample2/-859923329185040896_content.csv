"Content"
"    <?php         &#xD;&#xA;    require_once 'Google/Client.php';     &#xD;&#xA;    require_once 'Google/Service/Analytics.php';       &#xD;&#xA;    session_start();      &#xD;&#xA;    $client = new Google_Client();&#xD;&#xA;        $client->setApplicationName(""""Client_Library_Examples"""");&#xD;&#xA;        $client->setDeveloperKey(""""{devkey}"""");  &#xD;&#xA;        $client->setClientId('{clientid}.apps.googleusercontent.com');&#xD;&#xA;        $client->setClientSecret('{clientsecret}');&#xD;&#xA;        $client->setRedirectUri('http://www.daimto.com/Tutorials/PHP/Oauth2.php');&#xD;&#xA;        $client->setScopes(array('https://www.googleapis.com/auth/analytics.readonly'));&#xD;&#xA;    &#xD;&#xA;        //For loging out.&#xD;&#xA;        if ($_GET['logout'] == """"1"""") {&#xD;&#xA;    	unset($_SESSION['token']);&#xD;&#xA;           }   &#xD;&#xA;    &#xD;&#xA;        // Step 2: The user accepted your access now you need to exchange it.&#xD;&#xA;        if (isset($_GET['code'])) {&#xD;&#xA;            &#xD;&#xA;        	$client->authenticate($_GET['code']);  &#xD;&#xA;        	$_SESSION['token'] = $client->getAccessToken();&#xD;&#xA;        	$redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];&#xD;&#xA;        	header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        // Step 1:  The user has not authenticated we give them a link to login    &#xD;&#xA;        if (!$client->getAccessToken() && !isset($_SESSION['token'])) {&#xD;&#xA;        	$authUrl = $client->createAuthUrl();&#xD;&#xA;        	print """"<a class='login' href='$authUrl'>Connect Me!</a>"""";&#xD;&#xA;            }        &#xD;&#xA;    &#xD;&#xA;        // Step 3: We have access we can now create our service&#xD;&#xA;        if (isset($_SESSION['token'])) {&#xD;&#xA;            print """"<a class='logout' href='"""".$_SERVER['PHP_SELF'].""""?logout=1'>LogOut</a><br>"""";&#xD;&#xA;        	$client->setAccessToken($_SESSION['token']);&#xD;&#xA;        	$service = new Google_Service_Analytics($client);    &#xD;&#xA;    &#xD;&#xA;            // request user accounts&#xD;&#xA;            $accounts = $service->management_accountSummaries->listManagementAccountSummaries();&#xD;&#xA;    &#xD;&#xA;           foreach ($accounts->getItems() as $item) {&#xD;&#xA;    		echo """"Account: """",$item['name'], """"  """" , $item['id'], """"<br /> \n"""";		&#xD;&#xA;    		foreach($item->getWebProperties() as $wp) {&#xD;&#xA;    			echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WebProperty: ' ,$wp['name'], """"  """" , $wp['id'], """"<br /> \n"""";    &#xD;&#xA;    			&#xD;&#xA;    			$views = $wp->getProfiles();&#xD;&#xA;    			if (!is_null($views)) {&#xD;&#xA;    				foreach($wp->getProfiles() as $view) {&#xD;&#xA;    				//	echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;View: ' ,$view['name'], """"  """" , $view['id'], """"<br /> \n"""";    &#xD;&#xA;    				}&#xD;&#xA;    			}&#xD;&#xA;    		}&#xD;&#xA;    	} // closes account summaries&#xD;&#xA;    &#xD;&#xA;        }&#xD;&#xA;     print """"<br><br><br>"""";&#xD;&#xA;     print """"Access from google: """" . $_SESSION['token']; &#xD;&#xA;    ?>"
