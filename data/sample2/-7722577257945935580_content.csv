"Content"
"    CREATE FUNCTION [dbo].[FN_ListToTable]&#xD;&#xA;    (&#xD;&#xA;         @SplitOn              char(1)              --REQUIRED, the character to split the @List string on&#xD;&#xA;        ,@List                 varchar(8000)        --REQUIRED, the list to split apart&#xD;&#xA;    )&#xD;&#xA;    RETURNS&#xD;&#xA;    @ParsedList table&#xD;&#xA;    (&#xD;&#xA;        ListValue varchar(500)&#xD;&#xA;    )&#xD;&#xA;    AS&#xD;&#xA;    BEGIN&#xD;&#xA;    &#xD;&#xA;    /**&#xD;&#xA;    Takes the given @List string and splits it apart based on the given @SplitOn character.&#xD;&#xA;    A table is returned, one row per split item, with a column name """"ListValue"""".&#xD;&#xA;    This function workes for fixed or variable lenght items.&#xD;&#xA;    Empty and null items will not be included in the results set.&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;    Returns a table, one row per item in the list, with a column name """"ListValue""""&#xD;&#xA;    &#xD;&#xA;    EXAMPLE:&#xD;&#xA;    ----------&#xD;&#xA;    SELECT * FROM dbo.FN_ListToTable(',','1,12,123,1234,54321,6,A,*,|||,,,,B')&#xD;&#xA;    &#xD;&#xA;        returns:&#xD;&#xA;            ListValue  &#xD;&#xA;            -----------&#xD;&#xA;            1&#xD;&#xA;            12&#xD;&#xA;            123&#xD;&#xA;            1234&#xD;&#xA;            54321&#xD;&#xA;            6&#xD;&#xA;            A&#xD;&#xA;            *&#xD;&#xA;            |||&#xD;&#xA;            B&#xD;&#xA;    &#xD;&#xA;            (10 row(s) affected)&#xD;&#xA;    &#xD;&#xA;    **/&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;    ----------------&#xD;&#xA;    --SINGLE QUERY-- --this will not return empty rows&#xD;&#xA;    ----------------&#xD;&#xA;    INSERT INTO @ParsedList&#xD;&#xA;            (ListValue)&#xD;&#xA;        SELECT&#xD;&#xA;            ListValue&#xD;&#xA;            FROM (SELECT&#xD;&#xA;                      LTRIM(RTRIM(SUBSTRING(List2, number+1, CHARINDEX(@SplitOn, List2, number+1)-number - 1))) AS ListValue&#xD;&#xA;                      FROM (&#xD;&#xA;                               SELECT @SplitOn + @List + @SplitOn AS List2&#xD;&#xA;                           ) AS dt&#xD;&#xA;                          INNER JOIN Numbers n ON n.Number < LEN(dt.List2)&#xD;&#xA;                      WHERE SUBSTRING(List2, number, 1) = @SplitOn&#xD;&#xA;                 ) dt2&#xD;&#xA;            WHERE ListValue IS NOT NULL AND ListValue!=''&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;    RETURN&#xD;&#xA;    &#xD;&#xA;    END --Function FN_ListToTable"
