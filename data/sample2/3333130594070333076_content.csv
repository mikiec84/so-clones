"Content"
"    Sub ButtonClick()&#xD;&#xA;    'TRUSTED CONNECTION&#xD;&#xA;        On Error GoTo errH&#xD;&#xA;       &#xD;&#xA;        Dim con As New ADODB.Connection&#xD;&#xA;        Dim rs As New ADODB.Recordset&#xD;&#xA;        Dim strPath As String&#xD;&#xA;        Dim intImportRow As Integer&#xD;&#xA;        Dim strFirstName, strLastName As String&#xD;&#xA;       &#xD;&#xA;        Dim server, username, password, table, database As String&#xD;&#xA;       &#xD;&#xA;       &#xD;&#xA;        With Sheets(""""Sheet1"""")&#xD;&#xA;               &#xD;&#xA;                server = .TextBox1.Text&#xD;&#xA;                table = .TextBox4.Text&#xD;&#xA;                database = .TextBox5.Text&#xD;&#xA;               &#xD;&#xA;               &#xD;&#xA;                If con.State <> 1 Then&#xD;&#xA;           &#xD;&#xA;                    con.Open """"Provider=SQLOLEDB;Data Source="""" & server & """";Initial Catalog="""" & database & """";Integrated Security=SSPI;""""&#xD;&#xA;                    'con.Open&#xD;&#xA;           &#xD;&#xA;                End If&#xD;&#xA;                'this is the TRUSTED connection string&#xD;&#xA;               &#xD;&#xA;                Set rs.ActiveConnection = con&#xD;&#xA;               &#xD;&#xA;                'delete all records first if checkbox checked&#xD;&#xA;                If .CheckBox1 Then&#xD;&#xA;                    con.Execute """"delete from tbl_demo""""&#xD;&#xA;                End If&#xD;&#xA;           &#xD;&#xA;                'set first row with records to import&#xD;&#xA;                'you could also just loop thru a range if you want.&#xD;&#xA;                intImportRow = 10&#xD;&#xA;               &#xD;&#xA;                Do Until .Cells(intImportRow, 1) = """"""""&#xD;&#xA;                    strFirstName = .Cells(intImportRow, 1)&#xD;&#xA;                    strLastName = .Cells(intImportRow, 2)&#xD;&#xA;                   &#xD;&#xA;                    'insert row into database&#xD;&#xA;                    con.Execute """"insert into tbl_demo (firstname, lastname) values ('"""" & strFirstName & """"', '"""" & strLastName & """"')""""&#xD;&#xA;                   &#xD;&#xA;                    intImportRow = intImportRow + 1&#xD;&#xA;                Loop&#xD;&#xA;               &#xD;&#xA;                MsgBox """"Done importing"""", vbInformation&#xD;&#xA;               &#xD;&#xA;                con.Close&#xD;&#xA;                Set con = Nothing&#xD;&#xA;       &#xD;&#xA;        End With&#xD;&#xA;       &#xD;&#xA;    Exit Sub&#xD;&#xA;    &#xD;&#xA;    errH:&#xD;&#xA;        MsgBox Err.Description&#xD;&#xA;    End Sub"
