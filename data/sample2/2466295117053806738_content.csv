"Content"
"    Public Class FTP&#xD;&#xA;            '-------------------------[BroCode]--------------------------&#xD;&#xA;            '----------------------------FTP-----------------------------&#xD;&#xA;            Private _credentials As System.Net.NetworkCredential&#xD;&#xA;            Sub New(ByVal _FTPUser As String, ByVal _FTPPass As String)&#xD;&#xA;                setCredentials(_FTPUser, _FTPPass)&#xD;&#xA;            End Sub&#xD;&#xA;            Public Sub UploadFile(ByVal _FileName As String, ByVal _UploadPath As String)&#xD;&#xA;                Dim _FileInfo As New System.IO.FileInfo(_FileName)&#xD;&#xA;                Dim _FtpWebRequest As System.Net.FtpWebRequest = CType(System.Net.FtpWebRequest.Create(New Uri(_UploadPath)), System.Net.FtpWebRequest)&#xD;&#xA;                _FtpWebRequest.Credentials = _credentials&#xD;&#xA;                _FtpWebRequest.KeepAlive = False&#xD;&#xA;                _FtpWebRequest.Timeout = 20000&#xD;&#xA;                _FtpWebRequest.Method = System.Net.WebRequestMethods.Ftp.UploadFile&#xD;&#xA;                _FtpWebRequest.UseBinary = True&#xD;&#xA;                _FtpWebRequest.ContentLength = _FileInfo.Length&#xD;&#xA;                Dim buffLength As Integer = 2048&#xD;&#xA;                Dim buff(buffLength - 1) As Byte&#xD;&#xA;                Dim _FileStream As System.IO.FileStream = _FileInfo.OpenRead()&#xD;&#xA;                Try&#xD;&#xA;                    Dim _Stream As System.IO.Stream = _FtpWebRequest.GetRequestStream()&#xD;&#xA;                    Dim contentLen As Integer = _FileStream.Read(buff, 0, buffLength)&#xD;&#xA;                    Do While contentLen <> 0&#xD;&#xA;                        _Stream.Write(buff, 0, contentLen)&#xD;&#xA;                        contentLen = _FileStream.Read(buff, 0, buffLength)&#xD;&#xA;                    Loop&#xD;&#xA;                    _Stream.Close()&#xD;&#xA;                    _Stream.Dispose()&#xD;&#xA;                    _FileStream.Close()&#xD;&#xA;                    _FileStream.Dispose()&#xD;&#xA;                Catch ex As Exception&#xD;&#xA;                    MessageBox.Show(ex.Message, """"Upload Error: """", MessageBoxButtons.OK, MessageBoxIcon.Error)&#xD;&#xA;                End Try&#xD;&#xA;            End Sub&#xD;&#xA;            Public Sub DownloadFile(ByVal _FileName As String, ByVal _ftpDownloadPath As String)&#xD;&#xA;                Try&#xD;&#xA;                    Dim _request As System.Net.FtpWebRequest = System.Net.WebRequest.Create(_ftpDownloadPath)&#xD;&#xA;                    _request.KeepAlive = False&#xD;&#xA;                    _request.Method = System.Net.WebRequestMethods.Ftp.DownloadFile&#xD;&#xA;                    _request.Credentials = _credentials&#xD;&#xA;                    Dim _response As System.Net.FtpWebResponse = _request.GetResponse()&#xD;&#xA;                    Dim responseStream As System.IO.Stream = _response.GetResponseStream()&#xD;&#xA;                    Dim fs As New System.IO.FileStream(_FileName, System.IO.FileMode.Create)&#xD;&#xA;                    responseStream.CopyTo(fs)&#xD;&#xA;                    responseStream.Close()&#xD;&#xA;                    _response.Close()&#xD;&#xA;                Catch ex As Exception&#xD;&#xA;                    MessageBox.Show(ex.Message, """"Download Error: """", MessageBoxButtons.OK, MessageBoxIcon.Error)&#xD;&#xA;                End Try&#xD;&#xA;            End Sub&#xD;&#xA;            Public Function GetDirectory(ByVal _ftpPath As String) As List(Of String)&#xD;&#xA;                Dim ret As New List(Of String)&#xD;&#xA;                Try&#xD;&#xA;                    Dim _request As System.Net.FtpWebRequest = System.Net.WebRequest.Create(_ftpPath)&#xD;&#xA;                    _request.KeepAlive = False&#xD;&#xA;                    _request.Method = System.Net.WebRequestMethods.Ftp.ListDirectoryDetails&#xD;&#xA;                    _request.Credentials = _credentials&#xD;&#xA;                    Dim _response As System.Net.FtpWebResponse = _request.GetResponse()&#xD;&#xA;                    Dim responseStream As System.IO.Stream = _response.GetResponseStream()&#xD;&#xA;                    Dim _reader As System.IO.StreamReader = New System.IO.StreamReader(responseStream)&#xD;&#xA;                    Dim FileData As String = _reader.ReadToEnd&#xD;&#xA;                    Dim Lines() As String = FileData.Split(New String() {Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries)&#xD;&#xA;                    For Each l As String In Lines&#xD;&#xA;                        ret.Add(l)&#xD;&#xA;                    Next&#xD;&#xA;                    _reader.Close()&#xD;&#xA;                    _response.Close()&#xD;&#xA;                Catch ex As Exception&#xD;&#xA;                    MessageBox.Show(ex.Message, """"Directory Fetch Error: """", MessageBoxButtons.OK, MessageBoxIcon.Error)&#xD;&#xA;                End Try&#xD;&#xA;                Return ret&#xD;&#xA;            End Function&#xD;&#xA;        &#xD;&#xA;            Private Sub setCredentials(ByVal _FTPUser As String, ByVal _FTPPass As String)&#xD;&#xA;                _credentials = New System.Net.NetworkCredential(_FTPUser, _FTPPass)&#xD;&#xA;            End Sub&#xD;&#xA;        End Class"
