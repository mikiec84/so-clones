"Content"
"    - (BOOL)ensureDatabaseOpen: (NSError **)error&#xD;&#xA;    {&#xD;&#xA;        // already created db connection&#xD;&#xA;        if (_contactDb != nil)&#xD;&#xA;        {&#xD;&#xA;            return YES;&#xD;&#xA;        }&#xD;&#xA;        NSLog(@"""">> ContactManager::ensureDatabaseOpen"""");    &#xD;&#xA;        if (![self ensureDatabasePrepared:error])&#xD;&#xA;        {&#xD;&#xA;            return NO;&#xD;&#xA;        }&#xD;&#xA;        const char *dbpath = [_dbPath UTF8String]; &#xD;&#xA;        if (sqlite3_open(dbpath, &_contactDb) != SQLITE_OK &&&#xD;&#xA;            error != nil)&#xD;&#xA;        {&#xD;&#xA;            *error = [[[NSError alloc] initWithDomain:@""""ContactsManager"""" code:1000 userInfo:nil] autorelease];&#xD;&#xA;            return NO;&#xD;&#xA;        }&#xD;&#xA;       NSLog(@""""opened"""");&#xD;&#xA;        return YES;&#xD;&#xA;    }&#xD;&#xA;    - (BOOL)ensureDatabasePrepared: (NSError **)error&#xD;&#xA;    {&#xD;&#xA;        // already prepared&#xD;&#xA;        if ((_dbPath != nil) &&&#xD;&#xA;            ([[NSFileManager defaultManager] fileExistsAtPath:_dbPath]))&#xD;&#xA;        {&#xD;&#xA;            return YES;&#xD;&#xA;        }&#xD;&#xA;        // db in main bundle - cant edit.  copy to library if !exist&#xD;&#xA;        NSString *dbTemplatePath = [[NSBundle mainBundle] pathForResource:@""""contacts"""" ofType:@""""db""""];&#xD;&#xA;        NSLog(@""""%@"""", dbTemplatePath);&#xD;&#xA;        NSString *libraryPath = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES) lastObject];&#xD;&#xA;        _dbPath = [libraryPath stringByAppendingPathComponent:@""""contacts.db""""];&#xD;&#xA;        NSLog(@""""dbPath: %@"""", _dbPath);&#xD;&#xA;        // copy db from template to library&#xD;&#xA;        if (![[NSFileManager defaultManager] fileExistsAtPath:_dbPath])&#xD;&#xA;        {&#xD;&#xA;            NSLog(@""""db not exists"""");&#xD;&#xA;            NSError *error = nil;&#xD;&#xA;            if (![[NSFileManager defaultManager] copyItemAtPath:dbTemplatePath toPath:_dbPath error:&error])&#xD;&#xA;            {&#xD;&#xA;                return NO;&#xD;&#xA;            }&#xD;&#xA;            NSLog(@""""copied"""");&#xD;&#xA;        }    &#xD;&#xA;        return YES;    &#xD;&#xA;    }"
