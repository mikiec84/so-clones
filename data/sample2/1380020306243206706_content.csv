"Content"
"    jQuery.fn.table2CSV = function (options) {&#xD;&#xA;        var options = jQuery.extend({&#xD;&#xA;            separator: ',',&#xD;&#xA;            header: [],&#xD;&#xA;            delivery: 'popup' // popup, value&#xD;&#xA;        },&#xD;&#xA;        options);&#xD;&#xA;    &#xD;&#xA;        var csvData = [];&#xD;&#xA;        var headerArr = [];&#xD;&#xA;        var el = this;&#xD;&#xA;    &#xD;&#xA;        //header&#xD;&#xA;        var numCols = options.header.length;&#xD;&#xA;        var tmpRow = []; // construct header avalible array&#xD;&#xA;    &#xD;&#xA;        if (numCols > 0) {&#xD;&#xA;            for (var i = 0; i < numCols; i++) {&#xD;&#xA;                tmpRow[tmpRow.length] = formatData(options.header[i]);&#xD;&#xA;            }&#xD;&#xA;        } else {&#xD;&#xA;            $(el).filter(':visible').find('th').each(function () {&#xD;&#xA;                if ($(this).css('display') != 'none') tmpRow[tmpRow.length] = formatData($(this).html());&#xD;&#xA;            });&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        row2CSV(tmpRow);&#xD;&#xA;    &#xD;&#xA;        // actual data&#xD;&#xA;        $(el).find('tr').each(function () {&#xD;&#xA;            var tmpRow = [];&#xD;&#xA;            $(this).filter(':visible').find('td').each(function () {&#xD;&#xA;                if ($(this).css('display') != 'none') tmpRow[tmpRow.length] = formatData($(this).html());&#xD;&#xA;            });&#xD;&#xA;            row2CSV(tmpRow);&#xD;&#xA;        });&#xD;&#xA;        if (options.delivery == 'popup') {&#xD;&#xA;            var mydata = csvData.join('\n');&#xD;&#xA;            return popup(mydata);&#xD;&#xA;        } else {&#xD;&#xA;            var mydata = csvData.join('\n');&#xD;&#xA;            return mydata;&#xD;&#xA;        }&#xD;&#xA;    &#xD;&#xA;        function row2CSV(tmpRow) {&#xD;&#xA;            var tmp = tmpRow.join('') // to remove any blank rows&#xD;&#xA;            // alert(tmp);&#xD;&#xA;            if (tmpRow.length > 0 && tmp != '') {&#xD;&#xA;                var mystr = tmpRow.join(options.separator);&#xD;&#xA;                csvData[csvData.length] = mystr;&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;        function formatData(input) {&#xD;&#xA;            // replace """" with â€œ&#xD;&#xA;            var regexp = new RegExp(/[""""]/g);&#xD;&#xA;            var output = input.replace(regexp, """"â€œ"""");&#xD;&#xA;            //HTML&#xD;&#xA;            var regexp = new RegExp(/\<[^\<]+\>/g);&#xD;&#xA;            var output = output.replace(regexp, """""""");&#xD;&#xA;            if (output == """""""") return '';&#xD;&#xA;            return '""""' + output + '""""';&#xD;&#xA;        }&#xD;&#xA;        function popup(data) {&#xD;&#xA;            var generator = window.open('', 'csv', 'height=400,width=600');&#xD;&#xA;            generator.document.write('<html><head><title>CSV</title>');&#xD;&#xA;            generator.document.write('</head><body >');&#xD;&#xA;            generator.document.write('<textArea cols=70 rows=15 wrap=""""off"""" >');&#xD;&#xA;            generator.document.write(data);&#xD;&#xA;            generator.document.write('</textArea>');&#xD;&#xA;            generator.document.write('</body></html>');&#xD;&#xA;            generator.document.close();&#xD;&#xA;            return true;&#xD;&#xA;        }&#xD;&#xA;    };"
