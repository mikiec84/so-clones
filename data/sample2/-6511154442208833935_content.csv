"Content"
"	<?php&#xD;&#xA;	define('FACEBOOK_APP_ID', 'your_app_id');&#xD;&#xA;	define('FACEBOOK_SECRET', 'your_app_secret');&#xD;&#xA;	function parse_signed_request($signed_request, $secret) {&#xD;&#xA;	list($encoded_sig, $payload) = explode('.', $signed_request, 2); &#xD;&#xA;	// decode the data&#xD;&#xA;	$sig = base64_url_decode($encoded_sig);&#xD;&#xA;	$data = json_decode(base64_url_decode($payload), true);&#xD;&#xA;	if (strtoupper($data['algorithm']) !== 'HMAC-SHA256') {&#xD;&#xA;		error_log('Unknown algorithm. Expected HMAC-SHA256');&#xD;&#xA;		return null;&#xD;&#xA;	}&#xD;&#xA;	// check sig&#xD;&#xA;	$expected_sig = hash_hmac('sha256', $payload, $secret, $raw = true);&#xD;&#xA;	if ($sig !== $expected_sig) {&#xD;&#xA;		error_log('Bad Signed JSON signature!');&#xD;&#xA;		return null;&#xD;&#xA;	}&#xD;&#xA;	return $data;&#xD;&#xA;	}&#xD;&#xA;	function base64_url_decode($input) {&#xD;&#xA;		return base64_decode(strtr($input, '-_', '+/'));&#xD;&#xA;	}&#xD;&#xA;	if ($_REQUEST) {&#xD;&#xA;	echo '<p>signed_request contents:</p>';&#xD;&#xA;	$response = parse_signed_request($_REQUEST['signed_request'], &#xD;&#xA;		                               FACEBOOK_SECRET);&#xD;&#xA;	echo '<pre>';&#xD;&#xA;	print_r($response);&#xD;&#xA;	echo '</pre>';&#xD;&#xA;	} else {&#xD;&#xA;	echo '$_REQUEST is empty';&#xD;&#xA;	}&#xD;&#xA;	?>"
