"Content"
"    private static final Pattern DIR_SEPORATOR = Pattern.compile(""""/"""");&#xD;&#xA;    &#xD;&#xA;    /**&#xD;&#xA;     * Raturns all available SD-Cards in the system (include emulated)&#xD;&#xA;     *&#xD;&#xA;     * Warning: Hack! Based on Android source code of version 4.3 (API 18)&#xD;&#xA;     * Because there is no standart way to get it.&#xD;&#xA;     * TODO: Test on future Android versions 4.4+&#xD;&#xA;     *&#xD;&#xA;     * @return paths to all available SD-Cards in the system (include emulated)&#xD;&#xA;     */&#xD;&#xA;    public static String[] getStorageDirectories()&#xD;&#xA;    {&#xD;&#xA;        // Final set of paths&#xD;&#xA;        final Set<String> rv = new HashSet<String>();&#xD;&#xA;        // Primary physical SD-CARD (not emulated)&#xD;&#xA;        final String rawExternalStorage = System.getenv(""""EXTERNAL_STORAGE"""");&#xD;&#xA;        // All Secondary SD-CARDs (all exclude primary) separated by """":""""&#xD;&#xA;        final String rawSecondaryStoragesStr = System.getenv(""""SECONDARY_STORAGE"""");&#xD;&#xA;        // Primary emulated SD-CARD&#xD;&#xA;        final String rawEmulatedStorageTarget = System.getenv(""""EMULATED_STORAGE_TARGET"""");&#xD;&#xA;        if(TextUtils.isEmpty(rawEmulatedStorageTarget))&#xD;&#xA;        {&#xD;&#xA;            // Device has physical external storage; use plain paths.&#xD;&#xA;            if(TextUtils.isEmpty(rawExternalStorage))&#xD;&#xA;            {&#xD;&#xA;                // EXTERNAL_STORAGE undefined; falling back to default.&#xD;&#xA;                rv.add(""""/storage/sdcard0"""");&#xD;&#xA;            }&#xD;&#xA;            else&#xD;&#xA;            {&#xD;&#xA;                rv.add(rawExternalStorage);&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;        else&#xD;&#xA;        {&#xD;&#xA;            // Device has emulated storage; external storage paths should have&#xD;&#xA;            // userId burned into them.&#xD;&#xA;            final String rawUserId;&#xD;&#xA;            if(Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN_MR1)&#xD;&#xA;            {&#xD;&#xA;                rawUserId = """""""";&#xD;&#xA;            }&#xD;&#xA;            else&#xD;&#xA;            {&#xD;&#xA;                final String path = Environment.getExternalStorageDirectory().getAbsolutePath();&#xD;&#xA;                final String[] folders = DIR_SEPORATOR.split(path);&#xD;&#xA;                final String lastFolder = folders[folders.length - 1];&#xD;&#xA;                boolean isDigit = false;&#xD;&#xA;                try&#xD;&#xA;                {&#xD;&#xA;                    Integer.valueOf(lastFolder);&#xD;&#xA;                    isDigit = true;&#xD;&#xA;                }&#xD;&#xA;                catch(NumberFormatException ignored)&#xD;&#xA;                {&#xD;&#xA;                }&#xD;&#xA;                rawUserId = isDigit ? lastFolder : """""""";&#xD;&#xA;            }&#xD;&#xA;            // /storage/emulated/0[1,2,...]&#xD;&#xA;            if(TextUtils.isEmpty(rawUserId))&#xD;&#xA;            {&#xD;&#xA;                rv.add(rawEmulatedStorageTarget);&#xD;&#xA;            }&#xD;&#xA;            else&#xD;&#xA;            {&#xD;&#xA;                rv.add(rawEmulatedStorageTarget + File.separator + rawUserId);&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;        // Add all secondary storages&#xD;&#xA;        if(!TextUtils.isEmpty(rawSecondaryStoragesStr))&#xD;&#xA;        {&#xD;&#xA;            // All Secondary SD-CARDs splited into array&#xD;&#xA;            final String[] rawSecondaryStorages = rawSecondaryStoragesStr.split(File.pathSeparator);&#xD;&#xA;            Collections.addAll(rv, rawSecondaryStorages);&#xD;&#xA;        }&#xD;&#xA;        return rv.toArray(new String[rv.size()]);&#xD;&#xA;    }"
