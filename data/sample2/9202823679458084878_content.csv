"Content"
"    Sub Basic_Example_1()&#xD;&#xA;        Dim MyPath As String, FilesInPath As String&#xD;&#xA;        Dim MyFiles() As String&#xD;&#xA;        Dim SourceRcount As Long, Fnum As Long&#xD;&#xA;        Dim mybook As Workbook, BaseWks As Worksheet&#xD;&#xA;        Dim sourceRange As Range, destrange As Range&#xD;&#xA;        Dim rnum As Long, CalcMode As Long&#xD;&#xA;    &#xD;&#xA;        'Fill in the path\folder where the files are&#xD;&#xA;        MyPath = """"C:\Users\Ron\test""""&#xD;&#xA;    &#xD;&#xA;        'Add a slash at the end if the user forget it&#xD;&#xA;        If Right(MyPath, 1) <> """"\"""" Then&#xD;&#xA;            MyPath = MyPath & """"\""""&#xD;&#xA;        End If&#xD;&#xA;    &#xD;&#xA;        'If there are no Excel files in the folder exit the sub&#xD;&#xA;        FilesInPath = Dir(MyPath & """"*.xl*"""")&#xD;&#xA;        If FilesInPath = """""""" Then&#xD;&#xA;            MsgBox """"No files found""""&#xD;&#xA;            Exit Sub&#xD;&#xA;        End If&#xD;&#xA;    &#xD;&#xA;        'Fill the array(myFiles)with the list of Excel files in the folder&#xD;&#xA;        Fnum = 0&#xD;&#xA;        Do While FilesInPath <> """"""""&#xD;&#xA;            Fnum = Fnum + 1&#xD;&#xA;            ReDim Preserve MyFiles(1 To Fnum)&#xD;&#xA;            MyFiles(Fnum) = FilesInPath&#xD;&#xA;            FilesInPath = Dir()&#xD;&#xA;        Loop&#xD;&#xA;    &#xD;&#xA;        'Change ScreenUpdating, Calculation and EnableEvents&#xD;&#xA;        With Application&#xD;&#xA;            CalcMode = .Calculation&#xD;&#xA;            .Calculation = xlCalculationManual&#xD;&#xA;            .ScreenUpdating = False&#xD;&#xA;            .EnableEvents = False&#xD;&#xA;        End With&#xD;&#xA;    &#xD;&#xA;        'Add a new workbook with one sheet&#xD;&#xA;        Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)&#xD;&#xA;        rnum = 1&#xD;&#xA;    &#xD;&#xA;        'Loop through all files in the array(myFiles)&#xD;&#xA;        If Fnum > 0 Then&#xD;&#xA;            For Fnum = LBound(MyFiles) To UBound(MyFiles)&#xD;&#xA;                Set mybook = Nothing&#xD;&#xA;                On Error Resume Next&#xD;&#xA;                Set mybook = Workbooks.Open(MyPath & MyFiles(Fnum))&#xD;&#xA;                On Error GoTo 0&#xD;&#xA;    &#xD;&#xA;                If Not mybook Is Nothing Then&#xD;&#xA;    &#xD;&#xA;                    On Error Resume Next&#xD;&#xA;    &#xD;&#xA;                    With mybook.Worksheets(1)&#xD;&#xA;                        Set sourceRange = .Range(""""A1:C1"""")&#xD;&#xA;                    End With&#xD;&#xA;    &#xD;&#xA;                    If Err.Number > 0 Then&#xD;&#xA;                        Err.Clear&#xD;&#xA;                        Set sourceRange = Nothing&#xD;&#xA;                    Else&#xD;&#xA;                        'if SourceRange use all columns then skip this file&#xD;&#xA;                        If sourceRange.Columns.Count >= BaseWks.Columns.Count Then&#xD;&#xA;                            Set sourceRange = Nothing&#xD;&#xA;                        End If&#xD;&#xA;                    End If&#xD;&#xA;                    On Error GoTo 0&#xD;&#xA;    &#xD;&#xA;                    If Not sourceRange Is Nothing Then&#xD;&#xA;    &#xD;&#xA;                        SourceRcount = sourceRange.Rows.Count&#xD;&#xA;    &#xD;&#xA;                        If rnum + SourceRcount >= BaseWks.Rows.Count Then&#xD;&#xA;                            MsgBox """"Sorry there are not enough rows in the sheet""""&#xD;&#xA;                            BaseWks.Columns.AutoFit&#xD;&#xA;                            mybook.Close savechanges:=False&#xD;&#xA;                            GoTo ExitTheSub&#xD;&#xA;                        Else&#xD;&#xA;    &#xD;&#xA;                            'Copy the file name in column A&#xD;&#xA;                            With sourceRange&#xD;&#xA;                                BaseWks.cells(rnum, """"A""""). _&#xD;&#xA;                                        Resize(.Rows.Count).Value = MyFiles(Fnum)&#xD;&#xA;                            End With&#xD;&#xA;    &#xD;&#xA;                            'Set the destrange&#xD;&#xA;                            Set destrange = BaseWks.Range(""""B"""" & rnum)&#xD;&#xA;    &#xD;&#xA;                            'we copy the values from the sourceRange to the destrange&#xD;&#xA;                            With sourceRange&#xD;&#xA;                                Set destrange = destrange. _&#xD;&#xA;                                                Resize(.Rows.Count, .Columns.Count)&#xD;&#xA;                            End With&#xD;&#xA;                            destrange.Value = sourceRange.Value&#xD;&#xA;    &#xD;&#xA;                            rnum = rnum + SourceRcount&#xD;&#xA;                        End If&#xD;&#xA;                    End If&#xD;&#xA;                    mybook.Close savechanges:=False&#xD;&#xA;                End If&#xD;&#xA;    &#xD;&#xA;            Next Fnum&#xD;&#xA;            BaseWks.Columns.AutoFit&#xD;&#xA;        End If&#xD;&#xA;    &#xD;&#xA;    ExitTheSub:&#xD;&#xA;        'Restore ScreenUpdating, Calculation and EnableEvents&#xD;&#xA;        With Application&#xD;&#xA;            .ScreenUpdating = True&#xD;&#xA;            .EnableEvents = True&#xD;&#xA;            .Calculation = CalcMode&#xD;&#xA;        End With&#xD;&#xA;    End Sub"
