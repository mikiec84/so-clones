"Content"
"    :: email.bat :::::::::::::::::::::::::::::::::::::::::::::::::::::&#xD;&#xA;    @echo off&#xD;&#xA;    setlocal&#xD;&#xA;    &#xD;&#xA;    :: use these settings to send from a gmail account&#xD;&#xA;    :: set port=465 and set SSL=True&#xD;&#xA;    &#xD;&#xA;    :: use these settings for standard email SMTP port and no encryption&#xD;&#xA;    :: set port=25 and set SSL=False&#xD;&#xA;    &#xD;&#xA;    :: Change these following items to use the same variables all the time&#xD;&#xA;    :: or use the command line to pass all the variables&#xD;&#xA;    &#xD;&#xA;    set Port=25&#xD;&#xA;    set SSL=False&#xD;&#xA;    set From=""""myemail@myemailserver.com""""&#xD;&#xA;    set To=""""recipient@server.com""""&#xD;&#xA;    set Subject=""""Subject line""""&#xD;&#xA;    set Body=""""Email Body in one line""""&#xD;&#xA;    set SMTPServer=""""mailservername.myemailserver.com""""&#xD;&#xA;    set User=""""username""""&#xD;&#xA;    set Pass=""""password""""&#xD;&#xA;    set fileattach=""""d:\myfolder\file.txt""""&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;    :: This section sets the command line arguments&#xD;&#xA;    :: use this format:  CALL email.bat """"myname@gmail.com"""" """"RecipientEmailAddress@server.com"""" """"Subject line"""" """"Email Body in one line"""" """"smtp.gmail.com""""  """"myname@gmail.com"""" """"password"""" """"d:\folder\filename to attach.txt""""&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;    if """"%~7"""" NEQ """""""" (&#xD;&#xA;    set From=""""%~1""""&#xD;&#xA;    set To=""""%~2""""&#xD;&#xA;    set Subject=""""%~3""""&#xD;&#xA;    set Body=""""%~4""""&#xD;&#xA;    set SMTPServer=""""%~5""""&#xD;&#xA;    set User=""""%~6""""&#xD;&#xA;    set Pass=""""%~7""""&#xD;&#xA;    set fileattach=""""%~8""""&#xD;&#xA;    )&#xD;&#xA;    &#xD;&#xA;    set """"vbsfile=%temp%\email-bat.vbs""""&#xD;&#xA;    del """"%vbsfile%"""" 2>nul&#xD;&#xA;    set cdoSchema=http://schemas.microsoft.com/cdo/configuration&#xD;&#xA;    echo >>""""%vbsfile%"""" Set objArgs       = WScript.Arguments&#xD;&#xA;    echo >>""""%vbsfile%"""" Set objEmail      = CreateObject(""""CDO.Message"""")&#xD;&#xA;    echo >>""""%vbsfile%"""" objEmail.From     = %From%&#xD;&#xA;    echo >>""""%vbsfile%"""" objEmail.To       = %To%&#xD;&#xA;    echo >>""""%vbsfile%"""" objEmail.Subject  = %Subject%&#xD;&#xA;    echo >>""""%vbsfile%"""" objEmail.Textbody = %body%&#xD;&#xA;    if exist %fileattach% echo >>""""%vbsfile%"""" objEmail.AddAttachment %fileattach%&#xD;&#xA;    echo >>""""%vbsfile%"""" with objEmail.Configuration.Fields&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/sendusing"""")        = 2 ' not local, smtp&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/smtpserver"""")       = %SMTPServer%&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/smtpserverport"""")   = %port%&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/smtpauthenticate"""") = 1 ' cdobasic&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/sendusername"""")     = %user%&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/sendpassword"""")     = %pass%&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/smtpusessl"""")       = %SSL%&#xD;&#xA;    echo >>""""%vbsfile%""""  .Item (""""%cdoSchema%/smtpconnectiontimeout"""") = 30&#xD;&#xA;    echo >>""""%vbsfile%""""  .Update&#xD;&#xA;    echo >>""""%vbsfile%"""" end with&#xD;&#xA;    echo >>""""%vbsfile%"""" objEmail.Send&#xD;&#xA;    &#xD;&#xA;    cscript.exe /nologo """"%vbsfile%""""&#xD;&#xA;    echo email sent (if variables were correct)&#xD;&#xA;    del """"%vbsfile%"""" 2>nul&#xD;&#xA;    goto :EOF"
