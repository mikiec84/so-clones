"Content"
"		 <?php &#xD;&#xA;		   $app_id = """"YOUR_APP_ID"""";&#xD;&#xA;		   $app_secret = """"YOUR_APP_SECRET"""";&#xD;&#xA;		   $my_url = """"YOUR_URL"""";&#xD;&#xA;		   session_start();&#xD;&#xA;		   $code = $_REQUEST[""""code""""];&#xD;&#xA;		   if(empty($code)) {&#xD;&#xA;			 $_SESSION['state'] = md5(uniqid(rand(), TRUE)); //CSRF protection&#xD;&#xA;			 $dialog_url = """"http://www.facebook.com/dialog/oauth?client_id="""" &#xD;&#xA;			   . $app_id . """"&redirect_uri="""" . urlencode($my_url) . """"&state=""""&#xD;&#xA;			   . $_SESSION['state'];&#xD;&#xA;			 echo(""""<script> top.location.href='"""" . $dialog_url . """"'</script>"""");&#xD;&#xA;		   }&#xD;&#xA;		   if($_REQUEST['state'] == $_SESSION['state']) {&#xD;&#xA;			 $token_url = """"https://graph.facebook.com/oauth/access_token?""""&#xD;&#xA;			   . """"client_id="""" . $app_id . """"&redirect_uri="""" . urlencode($my_url)&#xD;&#xA;			   . """"&client_secret="""" . $app_secret . """"&code="""" . $code;&#xD;&#xA;			 $response = @file_get_contents($token_url);&#xD;&#xA;			 $params = null;&#xD;&#xA;			 parse_str($response, $params);&#xD;&#xA;			 $graph_url = """"https://graph.facebook.com/me?access_token="""" &#xD;&#xA;			   . $params['access_token'];&#xD;&#xA;			 $user = json_decode(file_get_contents($graph_url));&#xD;&#xA;			 echo(""""Hello """" . $user->name);&#xD;&#xA;		   }&#xD;&#xA;		   else {&#xD;&#xA;			 echo(""""The state does not match. You may be a victim of CSRF."""");&#xD;&#xA;		   }&#xD;&#xA;		 ?>"
