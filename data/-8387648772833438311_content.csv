"Content"
"     Sub XMLHTTP()&#xD;&#xA;    Dim url As String, lastRow As Long&#xD;&#xA;    Dim XMLHTTP As Object, html As Object, objResultDiv As Object, objH3 As Object, link As Object&#xD;&#xA;    Dim start_time As Date&#xD;&#xA;    Dim end_time As Date&#xD;&#xA;    lastRow = Range(""""A"""" & Rows.Count).End(xlUp).Row&#xD;&#xA;    Dim cookie As String&#xD;&#xA;    Dim result_cookie As String&#xD;&#xA;    start_time = Time&#xD;&#xA;    Debug.Print """"start_time:"""" & start_time&#xD;&#xA;    For i = 2 To lastRow&#xD;&#xA;        url = """"https://www.google.co.in/search?q="""" & Cells(i, 1) & """"&rnd="""" & WorksheetFunction.RandBetween(1, 10000)&#xD;&#xA;        Set XMLHTTP = CreateObject(""""MSXML2.serverXMLHTTP"""")&#xD;&#xA;        XMLHTTP.Open """"GET"""", url, False&#xD;&#xA;        XMLHTTP.setRequestHeader """"Content-Type"""", """"text/xml""""&#xD;&#xA;        XMLHTTP.setRequestHeader """"User-Agent"""", """"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0""""&#xD;&#xA;        XMLHTTP.send&#xD;&#xA;            Set html = CreateObject(""""htmlfile"""")&#xD;&#xA;        html.body.innerHTML = XMLHTTP.ResponseText&#xD;&#xA;        Set objResultDiv = html.getelementbyid(""""rso"""")&#xD;&#xA;        Set objH3 = objResultDiv.getelementsbytagname(""""H3"""")(0)&#xD;&#xA;        Set link = objH3.getelementsbytagname(""""a"""")(0)&#xD;&#xA;        str_text = Replace(link.innerHTML, """"<EM>"""", """""""")&#xD;&#xA;        str_text = Replace(str_text, """"</EM>"""", """""""")&#xD;&#xA;        Cells(i, 2) = str_text&#xD;&#xA;        Cells(i, 3) = link.href&#xD;&#xA;        DoEvents&#xD;&#xA;    Next&#xD;&#xA;    end_time = Time&#xD;&#xA;    Debug.Print """"end_time:"""" & end_time&#xD;&#xA;    Debug.Print """"done"""" & """"Time taken : """" & DateDiff(""""n"""", start_time, end_time)&#xD;&#xA;        MsgBox """"done"""" & """"Time taken : """" & DateDiff(""""n"""", start_time, end_time)&#xD;&#xA;    End Sub"
