"Content"
"	private static void ExecuteSqlTransaction(string connectionString)&#xD;&#xA;	{&#xD;&#xA;		using (SqlConnection connection = new SqlConnection(connectionString))&#xD;&#xA;		{&#xD;&#xA;			connection.Open();&#xD;&#xA;			SqlCommand command = connection.CreateCommand();&#xD;&#xA;			SqlTransaction transaction;&#xD;&#xA;			// Start a local transaction.&#xD;&#xA;			transaction = connection.BeginTransaction(""""SampleTransaction"""");&#xD;&#xA;			// Must assign both transaction object and connection&#xD;&#xA;			// to Command object for a pending local transaction&#xD;&#xA;			command.Connection = connection;&#xD;&#xA;			command.Transaction = transaction;&#xD;&#xA;			try&#xD;&#xA;			{&#xD;&#xA;				command.CommandText =&#xD;&#xA;					""""Insert into Region (RegionID, RegionDescription) VALUES (100, 'Description')"""";&#xD;&#xA;				command.ExecuteNonQuery();&#xD;&#xA;				command.CommandText =&#xD;&#xA;					""""Insert into Region (RegionID, RegionDescription) VALUES (101, 'Description')"""";&#xD;&#xA;				command.ExecuteNonQuery();&#xD;&#xA;				// Attempt to commit the transaction.&#xD;&#xA;				transaction.Commit();&#xD;&#xA;				Console.WriteLine(""""Both records are written to database."""");&#xD;&#xA;			}&#xD;&#xA;			catch (Exception ex)&#xD;&#xA;			{&#xD;&#xA;				Console.WriteLine(""""Commit Exception Type: {0}"""", ex.GetType());&#xD;&#xA;				Console.WriteLine(""""  Message: {0}"""", ex.Message);&#xD;&#xA;				// Attempt to roll back the transaction.&#xD;&#xA;				try&#xD;&#xA;				{&#xD;&#xA;					transaction.Rollback();&#xD;&#xA;				}&#xD;&#xA;				catch (Exception ex2)&#xD;&#xA;				{&#xD;&#xA;					// This catch block will handle any errors that may have occurred&#xD;&#xA;					// on the server that would cause the rollback to fail, such as&#xD;&#xA;					// a closed connection.&#xD;&#xA;					Console.WriteLine(""""Rollback Exception Type: {0}"""", ex2.GetType());&#xD;&#xA;					Console.WriteLine(""""  Message: {0}"""", ex2.Message);&#xD;&#xA;				}&#xD;&#xA;			}&#xD;&#xA;		}&#xD;&#xA;	}"
