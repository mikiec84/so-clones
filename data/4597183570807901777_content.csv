"Content"
"    Public Function ISO_WeekYearNumber( _&#xD;&#xA;        ByVal datDate As Date, _&#xD;&#xA;        Optional ByRef intYear As Integer, _&#xD;&#xA;        Optional ByRef bytWeek As Byte) _&#xD;&#xA;        As String&#xD;&#xA;    &#xD;&#xA;    ' Calculates and returns year and week number for date datDate according to the ISO 8601:1988 standard.&#xD;&#xA;    ' Optionally returns numeric year and week.&#xD;&#xA;    ' 1998-2007, Gustav Brock, Cactus Data ApS, CPH.&#xD;&#xA;    ' May be freely used and distributed.&#xD;&#xA;    &#xD;&#xA;        Const cbytFirstWeekOfAnyYear  As Byte = 1&#xD;&#xA;        Const cbytLastWeekOfLeapYear  As Byte = 53&#xD;&#xA;        Const cbytMonthJanuary        As Byte = 1&#xD;&#xA;        Const cbytMonthDecember       As Byte = 12&#xD;&#xA;        Const cstrSeparatorYearWeek   As String = """"W""""&#xD;&#xA;        &#xD;&#xA;        Dim bytMonth                  As Byte&#xD;&#xA;        Dim bytISOThursday            As Byte&#xD;&#xA;        Dim datLastDayOfYear          As Date&#xD;&#xA;        &#xD;&#xA;        intYear = Year(datDate)&#xD;&#xA;        bytMonth = Month(datDate)&#xD;&#xA;        bytWeek = DatePart(""""ww"""", datDate, vbMonday, vbFirstFourDays)&#xD;&#xA;        &#xD;&#xA;        If bytWeek = cbytLastWeekOfLeapYear Then&#xD;&#xA;            bytISOThursday = Weekday(vbThursday, vbMonday)&#xD;&#xA;            datLastDayOfYear = DateSerial(intYear, cbytMonthDecember, 31)&#xD;&#xA;            If Weekday(datLastDayOfYear, vbMonday) >= bytISOThursday Then&#xD;&#xA;                ' OK, week count of 53 is caused by leap year.&#xD;&#xA;            Else&#xD;&#xA;                ' Correct for Access97/2000+ bug.&#xD;&#xA;                bytWeek = cbytFirstWeekOfAnyYear&#xD;&#xA;            End If&#xD;&#xA;        End If&#xD;&#xA;        &#xD;&#xA;        ' Adjust year where week number belongs to next or previous year.&#xD;&#xA;        If bytMonth = cbytMonthJanuary Then&#xD;&#xA;            If bytWeek >= cbytLastWeekOfLeapYear - 1 Then&#xD;&#xA;                ' This is an early date of January belonging to the last week of the previous year.&#xD;&#xA;                intYear = intYear - 1&#xD;&#xA;            End If&#xD;&#xA;        ElseIf bytMonth = cbytMonthDecember Then&#xD;&#xA;            If bytWeek = cbytFirstWeekOfAnyYear Then&#xD;&#xA;                ' This is a late date of December belonging to the first week of the next year.&#xD;&#xA;                intYear = intYear + 1&#xD;&#xA;            End If&#xD;&#xA;        End If&#xD;&#xA;        &#xD;&#xA;        ISO_WeekYearNumber = CStr(intYear) & cstrSeparatorYearWeek & Format(bytWeek, """"00"""")&#xD;&#xA;    &#xD;&#xA;    End Function"
